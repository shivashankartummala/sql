
Customer[custid, cname, dob, city]
cust_order [custid, orderid, orderdate, orderstaus,  ordertotal]
orderdetails [orderid, itemid, unitprice, quantity]


1. show list of customer names with their latest order.
  A. select cname, orderid, orderdate 
         from customer c, cust_order co where c.custid=co.custid and 
         co.orderdate=(select max(orderdate) from cust_order oo where co.custid=oo/custid );
2.        
         
3. select top five customers by sales
    SELECT cname, city,
        (SELECT SUM(unitprice * quantity) FROM cust_order
            INNER JOIN
                cust_order ON orderdetails.orderid = cust_order.orderid
                WHERE
                cust_order.custid = customer.custid) AS total
    FROM customer ORDER BY total DESC LIMIT 5;     
    
  4. a correlated subquery in WHERE clause to find customers that have total sales more than 100K
    A. SELECT cname, city FROM customer WHERE  100000 < (
                  SELECT SUM(unitprice * quantity) FROM orderdetails 
                     INNER JOIN
                         orderdetails ON orderdetails.orderid = cust_order.orderid
                      WHERE cust_order.custid = customer.custid);
  5. using Having clause
     A. SELECT companyname, city FROM customers WHERE 100000 < (
                         SELECT SUM(unitprice * quantity) FROM orderdetails
                            INNER JOIN
                                  orderdetails ON orderdetails.orderid = cust_order.orderid
                            WHERE cust_order.custid = customer.custid);
    
